Meine Güte, was für ein Tag. Es fing damit an, dass \...
========================================================

Date: 2014-04-08 22:14:54

Meine Güte, was für ein Tag. Es fing damit an, dass der gatling mit
openssl, den ich gestern auf dem Server selbst gebaut hatte, nicht
funktionierte. Ich hatte an den Bauteilen kürzlich ein paar
Veränderungen vorgenommen, aber zuhause getestet und da ging es.
Unterschied: gcc 4.8.0 und 4.8.2. Also wollte ich auf dem Server mal gcc
updaten, dann auch gleich mit x32-Support. Dafür fehlte aber die glibc,
und eigentlich könnte ich ja auch gleich mal die glibc updaten,
entschloss ich mich. Das zerschoss dann aber den ld.so, weil das ranzige
Debian, das das auf dem Server mal war, /lib und /lib64 per Symlink auf
das gleiche Verzeichnis zeigen lässt. Daraufhin ging sudo nicht mehr.

Naja, kein Problem, dachte ich mir, für sowas gibt es ja eine
Rescue-Umgebung. Wollte die klicken --- der Knopf fehlte im
Webinterface. Nanu? Ticket aufgemacht. Knopf da. Knopf gedrückt ---
Server platt, kein Rescue kommt hoch. Ticket aufgemacht. Pause. Antwort:
Wir haben da mal ne Intel e100 NIC eingebaut, damit das Rescue
hochkommt, und die Onboard-NIC ausgemacht. Musst du dann in deinem
Debian fixen.

Die Meldung sah ich aber erst, nachdem ich mein Problem gefixt hatte,
und umgebootet hatte, und da kam dann das System zwar hoch, aber ohne
Netzwerk.

Also zurück ins Rescue, aber das kam dann auch nicht mehr hoch. Ticket
aufgemacht. Die haben irgendwas gebastelt, damit kam das wieder hoch.

Oh, erwähnte ich, dass das Rescue-System ohne mdadm kam? Ich hab seit
gefühlt 10 Jahren kein Rescue-System mehr gebraucht. Stellt sich raus,
dass sowas heutzutage ein richtiges Debian ist, wo man konfigurieren
kann, inklusive apt-get install mdadm. Allerdings will er dafür über 50
MB nachladen, also hab ich lieber ein statisches dietlibc-mdadm
hochgeladen und benutzt.

Das Problem, so stellte sich raus, war: Die e100-Netzwerkkarte möchte
gerne Firmware nachladen, die nicht da war. Ich trag also das Repository
ein und rufe apt-get auf \... da baut irgendein Debian-Automatismus eine
initrd neu und die ist nicht mehr bootfähig.

Nun hat mir der Hoster freundlicherweise ein KVM zur Verfügung gestellt,
sonst hätte ich den Aspekt gar nicht sehen können. Aber mit der neuen
initrd fand der Kernel sein root-fd nicht und panicte.

Die nächsten Schritte waren: Debian dist-upgrade (das war noch ein
wheezy), grub erneuern, grub stirbt mit symbol grub\_divmod64\_full not
found. Bekanntes Problem, offenbar, aber die Lösungen funktionierten
alle nicht. purge, reinstall, deinstall, config fummel, reinstall, auf
die zweite platte auch installieren, half alles nichts.

In der Mitte hatte ich noch versucht, einen eigenen Kernel zu bauen, der
auf der Hardware laufen würde, aber der tat es nicht und auf dem
80x25-Screen der KVM sah ich dann auch nur die letzten statischen Zeilen
eines genischen Panic-Stackdumps und konnte nicht hochscrollen. Aus
irgendeinem Grund kamen Tastatureingaben nicht an über die KVM. Ich
tippe auf ein Java-Problem, aber am Ende --- who cares.

Der einzige Ausweg war am Ende, dass ich einen eigenen grub 2.02 beta 2
aus den Sourcen kompiliert habe. Der warf zwar auch noch lustige
Fehlermeldungen, aber hat dann am Ende den Kernel doch gebootet.

So, jetzt hab ich zwar immer noch einen veralteten gcc und eine
veraltete glibc, aber immerhin ist die Kiste wieder oben. Seufz.
